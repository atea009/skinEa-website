<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SkinEa</title>
    <link rel="stylesheet" href="styles.css" />
</head>

<body>

    <div class="app-container">
        <header class="header">
            <div class="top-bar">
                <a href="home.html">
                    <img src="icons/SkinEa.png" alt="SkinEa logo" class="skinea_logo" />
                </a>

                <img src="icons/settings_icon.png" alt="Settings" class="settings-icon" />
            </div>
        </header>

        <div class="settings-popup-overlay" id="settingsPopupOverlay"></div>

        <div class="settings-popup" id="settingsPopup">
            <div class="popup-header">
                <img src="icons/back1.png" alt="Back" class="popup-back" id="settingsCloseBtn" />
                <h2>Profile</h2>
            </div>

            <div class="popup-scroll-area">

                <!-- My Details veç -->

                <div class="popup-option standalone" id="detailsToggle">
                    <img src="icons/user.png" />
                    <span>My Details</span>
                </div>
                <div class="details-dropdown" id="detailsDropdown">
                    <!-- Përmbajtja e xhepit -->
                    <p class="detail-line">Username: Atea</p>
                    <p class="detail-line">Email: skin@example.com</p>
                    <div class="detail-group">
                        <div class="detail-row">
                            <span class="detail-label">Gender</span>
                            <select class="detail-select">
                            <option>Female</option>
                            <option>Male</option>
                            <option>Other</option>
                          </select>
                        </div>

                        <div class="detail-row">
                            <span class="detail-label">Birthyear</span>
                            <input type="date" class="detail-input" />
                        </div>
                    </div>
                    <div class="skin-section">
                        <p class="detail-label">Skin Color</p>
                        <div class="skincolor-grid">
                            <div class="skincolor color-1 "></div>
                            <div class="skincolor color-2"></div>
                            <div class="skincolor color-3 selected"></div>
                            <div class="skincolor color-4"></div>
                            <div class="skincolor color-5"></div>
                            <div class="skincolor color-6"></div>
                        </div>
                    </div>


                    <div class="skin-section">
                        <p class="detail-label">Skin Type</p>
                        <div class="skin-types">
                            <button class="skin-btn selected">Normal</button>
                            <button class="skin-btn ">Combined</button>
                            <button class="skin-btn">Oily</button>
                            <button class="skin-btn">Dry</button>
                        </div>
                    </div>

                    <div class="skin-section">
                        <p class="detail-label">Skin Issue</p>
                        <div class="issue-tags">
                            <button class="issue-btn">Acne</button>
                            <button class="issue-btn">Redness/ Rosacea</button>
                            <button class="issue-btn">Wrinkles/ Fine lines</button>
                            <button class="issue-btn">Enlarged pores</button>
                            <button class="issue-btn">Skin texture</button>
                            <button class="issue-btn">Pigmentation</button>
                            <button class="issue-btn">Sensitivity</button>
                            <button class="issue-btn">Dark circles</button>
                        </div>
                    </div>


                </div>

                <!-- Grupi tjeter -->
                <div class="options-group">

                    <a class="popup-option" href="howtouse.html">
                        <img src="icons/info.png" />
                        <span>How to Use</span>
                    </a>
                    <a class="popup-option" href="guide.html">
                        <img src="icons/question.png" />
                        <span>SkinEa Guide</span>
                    </a>
                    <a class="popup-option" href="privacy.html">
                        <img src="icons/policy.png" />
                        <span>Privacy Policy</span>
                    </a>
                    <a class="popup-option" href="terms.html">
                        <img src="icons/terms.png" />
                        <span>Terms of Use</span>
                    </a>

                    <div class="popup-option" id="shareAppBtn">
                        <img src="icons/share.png" />
                        <span>Share App</span>
                    </div>

                    <a href="mailto:skineaapp@gmail.com" class="popup-option">
                        <img src="icons/email.png" />
                        <span>Contact Us</span>
                    </a>

                    <div class="popup-option">
                        <img src="icons/star.png" />
                        <span>Rate Us</span>
                    </div>
                </div>
                <div class="logout-container">
                    <button class="logout-btn" onclick="window.location.href='index.html'">Log Out</button>
                </div>

            </div>
        </div>



        <main>
            <section class="wishlist-section">
                <section class="favourite-product-section">
                    <h2 class="section-title">Favourite products</h2>

                    <div class="products-grid">

                        <div class="product-card" style="display: none">
                            <div class="card-top">
                                <img src="icons/prod_image.png" alt="Product Image" class="product-photo" />
                                <button class="wishlist-container" data-active="false">
                                <img src="icons/heart.png" alt="Wishlist" class="wishlist-icon" />
                            </button>
                            </div>

                            <div class="card-bottom">
                                <span class="skin-type" data-skin=""></span>
                                <p class="brand-name"></p>
                                <p class="product-name"></p>
                            </div>
                        </div>

                    </div>


                    <div class="popup-overlay" id="popupOverlay">
                        <div class="product-popup" id="productPopup">
                            <div class="product-popup-content">
                                <div class="popup-indicator"></div>

                                <div class="popup-product">
                                    <div class="popup-image-container">
                                        <img src="icons/prod_image.png" alt="Product Image" class="popup-product-photo" />
                                        <div class="wishlist-container-popup">
                                            <img src="icons/heart.png" alt="Wishlist" class="popup-wishlist-icon" />
                                        </div>
                                    </div>
                                    <div class="popup-product-name">
                                        <p class="popup-brand-name">Product Brand</p>
                                        <p class="popup-product-name-bold">Product Name Name</p>
                                    </div>
                                    <button class="buy-button">Buy Now</button>
                                </div>


                                <div class="popup-section">
                                    <h2>How to use product</h2>
                                    <p class="popup-text">
                                        For combination skin with sensitivity, gently apply the toner using a cotton pad, focusing on areas prone to redness and irritation...
                                    </p>
                                </div>

                                <div class="popup-section">
                                    <h2>Ingredients</h2>
                                    <p class="popup-text">
                                        Water, Hydrogenated Hydrolysate Starch, Sodium Pca, Allantoin, Phenoxyethanol, Disodium Edta...
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>

                </section>
        </main>


        <footer class="footer">
            <div class="footer-nav">
                <a href="aichat.html" class="footer-btn">
                    <img src="icons/Ai_icon.png" alt="AI Chat" />
                    <span>AI Chat</span>
                </a>
                <a href="scan.html" class="footer-btn">
                    <img src="icons/scan.png" alt="Mole Scan" />
                    <span>Scanner</span>
                </a>
                <a href="home.html" class="footer-btn">
                    <img src="icons/home_icon.png" alt="Home" />
                    <span>Home</span>
                </a>
                <a href="products.html" class="footer-btn">
                    <img src="icons/products_icon.png" alt="Products" />
                    <span>Products</span>
                </a>
                <a href="blog.html" class="footer-btn">
                    <img src="icons/blog_icon.png" alt="Blog" />
                    <span>Blog</span>
                </a>
            </div>

            <div class="home-indicator">
                <img src="icons/home_indicator.png" alt="home_indicator" />
            </div>
        </footer>

    </div>

    <script>
        const settingsIcon = document.querySelector('.settings-icon');
        const settingsPopup = document.getElementById('settingsPopup');
        const settingsOverlay = document.getElementById('settingsPopupOverlay');
        const settingsCloseBtn = document.getElementById('settingsCloseBtn');
        const detailsToggle = document.getElementById('detailsToggle');
        const detailsDropdown = document.getElementById('detailsDropdown');

        // Hap popup
        function openSettingsPopup() {
            settingsPopup.style.transform = 'translate(-50%, 0)';
            settingsOverlay.style.display = 'block';
        }

        // Mbyll popup + dropdown
        function closeSettingsPopup() {
            settingsPopup.style.transform = 'translate(-50%, 100%)';
            setTimeout(() => {
                settingsOverlay.style.display = 'none';
                detailsDropdown.style.display = 'none'; // mbyll dropdown automatikisht
            }, 700);
        }

        // Klikime
        settingsIcon.addEventListener('click', openSettingsPopup);
        settingsCloseBtn.addEventListener('click', closeSettingsPopup);
        settingsOverlay.addEventListener('click', closeSettingsPopup);

        // Mbyllje me swipe nga pjesa e sipërme (vetëm 5% e sipërme aktive)
        let settingsStartY = 0;
        let settingsCurrentY = 0;
        let isSwiping = false;

        settingsPopup.addEventListener('touchstart', (e) => {
            const touchY = e.touches[0].clientY;
            const popupTop = settingsPopup.getBoundingClientRect().top;
            const height = settingsPopup.offsetHeight;

            if ((touchY - popupTop) <= height * 0.05) {
                settingsStartY = touchY;
                isSwiping = true;
                settingsPopup.style.transition = 'none';
            }
        });

        settingsPopup.addEventListener('touchmove', (e) => {
            if (!isSwiping) return;
            settingsCurrentY = e.touches[0].clientY;
            const diffY = settingsCurrentY - settingsStartY;
            if (diffY > 0) {
                settingsPopup.style.transform = `translate(-50%, ${diffY}px)`;
            }
        });

        settingsPopup.addEventListener('touchend', () => {
            if (!isSwiping) return;
            isSwiping = false;

            const diffY = settingsCurrentY - settingsStartY;
            settingsPopup.style.transition = 'transform 0.7s ease-in-out';

            if (diffY > 100) {
                closeSettingsPopup();
            } else {
                settingsPopup.style.transform = 'translate(-50%, 0)';
            }
        });

        // Dropdown toggle për "My Details"
        detailsToggle.addEventListener('click', () => {
            if (detailsDropdown.style.display === 'block') {
                detailsDropdown.style.display = 'none';
            } else {
                detailsDropdown.style.display = 'block';
            }
        });
    </script>

    <script>
        document.querySelectorAll('.skincolor').forEach(circle => {
            circle.addEventListener('click', () => {
                document.querySelectorAll('.skincolor').forEach(c => c.classList.remove('selected'));
                circle.classList.add('selected');
            });
        });
    </script>

    <script>
        document.querySelectorAll('.skin-btn').forEach(button => {
            button.addEventListener('click', () => {
                document.querySelectorAll('.skin-btn').forEach(btn => btn.classList.remove('selected'));
                button.classList.add('selected');
            });
        });
    </script>

    <script>
        document.querySelectorAll('.issue-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                btn.classList.toggle('selected');
            });
        });
    </script>

    <script>
        const shareBtn = document.getElementById('shareAppBtn');
        shareBtn.addEventListener('click', async() => {
            if (navigator.share) {
                try {
                    await navigator.share({
                        title: 'SkinEa App',
                        text: 'Check out this skincare assistant app!',
                        url: 'https://skinea.netlify.app/'
                    });
                } catch (err) {
                    console.error('Sharing failed:', err);
                }
            } else {
                alert('Sharing not supported on this device/browser.');
            }
        });
    </script>




    <script>
        const wishlistButtons = document.querySelectorAll('.wishlist-container');

        wishlistButtons.forEach(button => {
            button.addEventListener('click', () => {
                const img = button.querySelector('img');
                const isActive = button.getAttribute('data-active') === "true";

                if (isActive) {
                    img.src = 'icons/heart.png'; // rikthehet në heart normal
                    button.setAttribute('data-active', "false");
                } else {
                    img.src = 'icons/active_heart.png'; // vendoset active heart
                    button.setAttribute('data-active', "true");
                }
            });
        });
    </script>


    <script>
        const skinTypeElements = document.querySelectorAll('.skin-type');

        skinTypeElements.forEach(el => {
            const skin = el.getAttribute('data-skin');

            if (skin) {
                switch (skin.trim().toLowerCase()) {
                    case "all skin types":
                        el.classList.add('skin-all');
                        el.textContent = "All skin types";
                        break;
                    case "normal skin":
                        el.classList.add('skin-normal');
                        el.textContent = "Normal skin";
                        break;
                    case "dry skin":
                        el.classList.add('skin-dry');
                        el.textContent = "Dry skin";
                        break;
                    case "oily skin":
                        el.classList.add('skin-oily');
                        el.textContent = "Oily skin";
                        break;
                    case "combination skin":
                        el.classList.add('skin-combination');
                        el.textContent = "Combination skin";
                        break;
                    case "dry/combo skin":
                        el.classList.add('skin-dry-combo');
                        el.textContent = "Dry/Combo skin";
                        break;
                    case "oily/combo skin":
                        el.classList.add('skin-oily-combo');
                        el.textContent = "Oily/Combo skin";
                        break;
                    default:
                        el.style.display = "none"; // fsheh nëse nuk ka kategori të saktë
                }
            }
        });
    </script>


    <script>
        const productCards = document.querySelectorAll('.product-card');
        const popup = document.getElementById('productPopup');
        const overlay = document.getElementById('popupOverlay');

        // Funksione për të ndaluar / rikthyer scroll-in në body
        const disableScroll = () => {
            document.body.style.overflow = 'hidden';
            document.body.style.position = 'fixed';
            document.body.style.width = '100%';
        };

        const enableScroll = () => {
            document.body.style.overflow = '';
            document.body.style.position = '';
            document.body.style.width = '';
        };

        // Funksion për të mbyllur popup-in me animacion smooth
        function closePopupSmooth() {
            popup.classList.add('closing-popup');
            popup.addEventListener('animationend', () => {
                popup.classList.remove('open');
                popup.classList.remove('closing-popup');
                overlay.classList.remove('active');
                popup.style.transform = 'translateY(100%)';
                enableScroll();
            }, {
                once: true
            });
        }

        // Hap popup-in kur klikojmë një kartë
        productCards.forEach(card => {
            card.addEventListener('click', function(event) {
                if (event.target.closest('.wishlist-container')) return;
                overlay.classList.add('active');
                popup.classList.add('open');
                popup.style.transform = 'translateY(0)';
                disableScroll();
            });
        });

        // Mbyll popup-in kur klikojmë jashtë (overlay)
        overlay.addEventListener('click', function(event) {
            if (event.target === overlay) {
                closePopupSmooth();
            }
        });

        // Drag për të mbyllur popup-in vetëm nga maja
        let isDragging = false;
        let startY = 0;
        let currentY = 0;
        let draggingAllowed = false;

        popup.addEventListener('touchstart', (e) => {
            startY = e.touches[0].clientY;
            currentY = startY;

            draggingAllowed = popup.scrollTop === 0;
            isDragging = true;

            if (draggingAllowed) {
                popup.style.transition = '';
            }
        });

        popup.addEventListener('touchmove', (e) => {
            if (!isDragging || !draggingAllowed) return;

            currentY = e.touches[0].clientY;
            const diff = currentY - startY;

            if (diff > 0) {
                popup.style.transform = `translateY(${diff}px)`;
            }
        });

        popup.addEventListener('touchend', () => {
            if (!isDragging || !draggingAllowed) return;

            isDragging = false;
            draggingAllowed = false;

            const diff = currentY - startY;

            if (diff > 100) {
                popup.style.transition = 'transform 0.3s ease';
                popup.style.transform = 'translateY(100%)';
                closePopupSmooth();
            } else {
                popup.style.transition = 'transform 0.3s ease';
                popup.style.transform = 'translateY(0)';
            }
        });

        // 🎯 Wishlist në popup - aktivizohet me klikim
        const popupWishlist = document.querySelector('.wishlist-container-popup');
        const wishlistIcon = popupWishlist.querySelector('img');

        popupWishlist.addEventListener('click', () => {
            const isActive = popupWishlist.classList.toggle('active');
            wishlistIcon.src = isActive ? 'icons/active_heart.png' : 'icons/heart.png';
        });
    </script>









    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="scripts/firebase.js"></script>
    <script src="scripts/wishlist.js"></script>

</body>

</html>